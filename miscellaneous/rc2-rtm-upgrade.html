

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Upgrading from RC2 to RTM &mdash; Документация Entity Framework Core 1.0.0</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
    <link rel="top" title="Документация Entity Framework Core 1.0.0" href="../index.html"/>
        <link rel="up" title="Разное" href="index.html"/>
        <link rel="next" title="Command Line Reference" href="cli/index.html"/>
        <link rel="prev" title="Обновление RC1 до RC2" href="rc1-rc2-upgrade.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Entity Framework Core
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Entity Framework Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platforms/index.html">Приступая к работе</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modeling/index.html">Создание модели</a></li>
<li class="toctree-l1"><a class="reference internal" href="../querying/index.html">Запрос данных</a></li>
<li class="toctree-l1"><a class="reference internal" href="../saving/index.html">Сохранение данных</a></li>
<li class="toctree-l1"><a class="reference internal" href="../efcore-vs-ef6/index.html">EF Core vs. EF6.x</a></li>
<li class="toctree-l1"><a class="reference internal" href="../providers/index.html">Провайдеры баз данных</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Разное</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="connection-strings.html">Connection Strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Логгирование</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Тестирование InMemory</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuring-dbcontext.html">Конфигурирование DbContext</a></li>
<li class="toctree-l2"><a class="reference internal" href="rc1-rc2-upgrade.html">Обновление RC1 до RC2</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Upgrading from RC2 to RTM</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cli/index.html">Command Line Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="internals/index.html">Что внутри</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Entity Framework Core</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Разное</a> &raquo;</li>
      
    <li>Upgrading from RC2 to RTM</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="admonition attention">
<p class="first admonition-title">Внимание</p>
<p class="last">Эта документация для EF Core. Для EF6.x и более ранних версий смотрите <a class="reference external" href="http://msdn.com/data/ef">http://msdn.com/data/ef</a>.</p>
</div>
<div class="section" id="upgrading-from-rc2-to-rtm">
<h1>Upgrading from RC2 to RTM<a class="headerlink" href="#upgrading-from-rc2-to-rtm" title="Ссылка на этот заголовок">¶</a></h1>
<p>This article provides guidance for moving an application built with the RC2 packages to 1.0.0 RTM.</p>
<div class="contents local topic" id="id1">
<p class="topic-title first"><cite>В этой статье:</cite></p>
<ul class="simple">
<li><a class="reference internal" href="#package-versions" id="id2">Package Versions</a></li>
<li><a class="reference internal" href="#existing-migrations-may-need-maxlength-added" id="id3">Existing migrations may need maxLength added</a></li>
<li><a class="reference internal" href="#net-core-remove-imports-in-project-json" id="id4">.NET Core: Remove &#8220;imports&#8221; in project.json</a></li>
<li><a class="reference internal" href="#uwp-add-binding-redirects" id="id5">UWP: Add binding redirects</a></li>
</ul>
</div>
<div class="section" id="package-versions">
<h2><a class="toc-backref" href="#id2">Package Versions</a><a class="headerlink" href="#package-versions" title="Ссылка на этот заголовок">¶</a></h2>
<p>The names of the top level packages that you would typically install into an application did not change between RC2 and RTM.</p>
<dl class="docutils">
<dt>You need to upgrade the installed packages to the RTM versions:</dt>
<dd><ul class="first last simple">
<li>Runtime packages (e.g. <code class="docutils literal"><span class="pre">Microsoft.EntityFrameworkCore.SqlServer</span></code>) changed from <code class="docutils literal"><span class="pre">1.0.0-rc2-final</span></code> to <code class="docutils literal"><span class="pre">1.0.0</span></code>.</li>
<li>The <code class="docutils literal"><span class="pre">Microsoft.EntityFrameworkCore.Tools</span></code> package changed from <code class="docutils literal"><span class="pre">1.0.0-preview1-final</span></code> to <code class="docutils literal"><span class="pre">1.0.0-preview2-final</span></code>. Note that tooling is still pre-release.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="existing-migrations-may-need-maxlength-added">
<h2><a class="toc-backref" href="#id3">Existing migrations may need maxLength added</a><a class="headerlink" href="#existing-migrations-may-need-maxlength-added" title="Ссылка на этот заголовок">¶</a></h2>
<p>In RC2, the column definition in a migration looked like <code class="docutils literal"><span class="pre">table.Column&lt;string&gt;(nullable:</span> <span class="pre">true)</span></code> and the length of the column was looked up in some metadata we store in the code behind the migration. In RTM, the length is now included in the scaffolded code <code class="docutils literal"><span class="pre">table.Column&lt;string&gt;(maxLength:</span> <span class="pre">450,</span> <span class="pre">nullable:</span> <span class="pre">true)</span></code>.</p>
<p>Any existing migrations that were scaffolded prior to using RTM will not have the <code class="docutils literal"><span class="pre">maxLength</span></code> argument specified. This means the maximum length supported by the database will be used (<code class="docutils literal"><span class="pre">nvarchar(max)</span></code> on SQL Server). This may be fine for some columns, but columns that are part of a key, foreign key, or index need to be updated to include a maximum length. By convention, 450 is the maximum length used for keys, foreign keys, and indexed columns. If you have explicitly configured a length in the model, then you should use that length instead.</p>
<p><strong>ASP.NET Identity</strong></p>
<p>This change impacts projects that use ASP.NET Identity and were created from a pre-RTM project template. The project template includes a migration used to create the database. This migration must be edited to specify a maximum length of <code class="docutils literal"><span class="pre">256</span></code> for the following columns.</p>
<blockquote>
<div><ul>
<li><dl class="first docutils">
<dt>AspNetRoles</dt>
<dd><ul class="first last simple">
<li>Name</li>
<li>NormalizedName</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>AspNetUsers</dt>
<dd><ul class="first last simple">
<li>Email</li>
<li>NormalizedEmail</li>
<li>NormalizedUserName</li>
<li>UserName</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>Failure to make this change will result in the following exception when the initial migration is applied to a database.</p>
<blockquote>
<div>System.Data.SqlClient.SqlException (0x80131904): Column &#8216;NormalizedName&#8217; in table &#8216;AspNetRoles&#8217; is of a type that is invalid for use as a key column in an index.</div></blockquote>
</div>
<div class="section" id="net-core-remove-imports-in-project-json">
<h2><a class="toc-backref" href="#id4">.NET Core: Remove &#8220;imports&#8221; in project.json</a><a class="headerlink" href="#net-core-remove-imports-in-project-json" title="Ссылка на этот заголовок">¶</a></h2>
<p>If you were targeting .NET Core with RC2, you needed to add <code class="docutils literal"><span class="pre">imports</span></code> to project.json as a temporary workaround for some of EF Core&#8217;s dependencies not supporting .NET Standard. These can now be removed.</p>
<div class="highlight-json"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;frameworks&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;netcoreapp1.0&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="hll">      <span class="nt">&quot;imports&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;dnxcore50&quot;</span><span class="p">,</span> <span class="s2">&quot;portable-net451+win8&quot;</span><span class="p">]</span>
</span>    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="uwp-add-binding-redirects">
<h2><a class="toc-backref" href="#id5">UWP: Add binding redirects</a><a class="headerlink" href="#uwp-add-binding-redirects" title="Ссылка на этот заголовок">¶</a></h2>
<p>Attempting to run EF commands on Universal Windows Platform (UWP) projects results in the following error:</p>
<blockquote>
<div>System.IO.FileLoadException: Could not load file or assembly &#8216;System.IO.FileSystem.Primitives, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a&#8217; or one of its dependencies. The located assembly&#8217;s manifest definition does not match the assembly reference.</div></blockquote>
<p>You need to manually add binding redirects to the UWP project. Create a file named <code class="docutils literal"><span class="pre">App.config</span></code> in the project root folder and add redirects to the correct assembly versions.</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;configuration&gt;</span>
 <span class="nt">&lt;runtime&gt;</span>
   <span class="nt">&lt;assemblyBinding</span> <span class="na">xmlns=</span><span class="s">&quot;urn:schemas-microsoft-com:asm.v1&quot;</span><span class="nt">&gt;</span>
     <span class="nt">&lt;dependentAssembly&gt;</span>
       <span class="nt">&lt;assemblyIdentity</span> <span class="na">name=</span><span class="s">&quot;System.IO.FileSystem.Primitives&quot;</span>
                         <span class="na">publicKeyToken=</span><span class="s">&quot;b03f5f7f11d50a3a&quot;</span>
                         <span class="na">culture=</span><span class="s">&quot;neutral&quot;</span> <span class="nt">/&gt;</span>
       <span class="nt">&lt;bindingRedirect</span> <span class="na">oldVersion=</span><span class="s">&quot;4.0.0.0&quot;</span>
                        <span class="na">newVersion=</span><span class="s">&quot;4.0.1.0&quot;</span><span class="nt">/&gt;</span>
     <span class="nt">&lt;/dependentAssembly&gt;</span>
     <span class="nt">&lt;dependentAssembly&gt;</span>
       <span class="nt">&lt;assemblyIdentity</span> <span class="na">name=</span><span class="s">&quot;System.Threading.Overlapped&quot;</span>
                         <span class="na">publicKeyToken=</span><span class="s">&quot;b03f5f7f11d50a3a&quot;</span>
                         <span class="na">culture=</span><span class="s">&quot;neutral&quot;</span> <span class="nt">/&gt;</span>
       <span class="nt">&lt;bindingRedirect</span> <span class="na">oldVersion=</span><span class="s">&quot;4.0.0.0&quot;</span>
                        <span class="na">newVersion=</span><span class="s">&quot;4.0.1.0&quot;</span><span class="nt">/&gt;</span>
     <span class="nt">&lt;/dependentAssembly&gt;</span>
   <span class="nt">&lt;/assemblyBinding&gt;</span>
 <span class="nt">&lt;/runtime&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cli/index.html" class="btn btn-neutral float-right" title="Command Line Reference" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="rc1-rc2-upgrade.html" class="btn btn-neutral" title="Обновление RC1 до RC2" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016 Microsoft.
      Обновлено: июл. 17, 2016.

    </p>
  </div> Документация лицензирована под <a href="https://creativecommons.org/licenses/by-nc/3.0/">CC BY-NC 3.0</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/wedc.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>